# IT 历史上的今天 - 视频全链路自动化播控中心使用手册

## 1. 系统设计理念 (Design Concept)

本系统旨在打造一个**端到端闭环的短视频自动化生产与流量追踪控制台**。为了满足每天生成 1 分钟级高质量科技史科普视频（面向抖音、视频号、小红书、YouTube）的需求，我们将整个工作流解耦：

底层逻辑是：**历史事件数据（基础资料） -> 影视工业流水线处理（调度追踪） -> 多平台宣发（效果回收）**。

- **数据层**：基于本地高并发轻量级 SQLite (`history_events` 表存底层素材，`video_jobs` 表管生产任务，`publish_metrics` 表查跨平台分发情况)。
- **应用层**：轻量级 Flask 后端结合基于原生 HTML/CSS 构建的高信息密度单页应用，保证了查询渲染速度与在移动设备局域网访问（192.168.x.x）的极简体验。
- **业务工作流**：将传统自媒体的繁琐制作流程，抽象为确定性的、基于 Node (节点) 的自动化大屏指挥站。

---

## 2. 核心界面及交互指南 (Core Pages & Operations)

### 2.1 大盘概览层：历史数据发现台 (`/` 即 `index.html`)

该页面是业务决策起点，你可以在这里挖掘可用的历史事件素材。

**【结构功能】**
*   **全局数据指标**: 顶部栏实时展示数据库内清洗出的有效条目总数（例如 3650 条）。
*   **多维筛选矩阵**: 
    1.  **关键词引擎**: 搜索标题或核心摘要（如“乔布斯”，“微软”）。
    2.  **日历漏斗**: 按月份检索（1月-12月），方便你提前储备某个月的栏目。
    3.  **分类/排序**: 可按照 AI 判定的“爆款指数 (Score 1-10)”倒序发掘高吸引力的黑天鹅事件，或按时间流排序。
*   **可视化追踪表格**:
    *   **流水线胶囊状态**: `UNSTARTED` (未建工单), `PENDING` (排队中), `SCRIPT_GEN` (剧本分镜就绪), `AUDIO_GEN` (音画合并中), `RENDER_COMPLETE` (压制成片)。
    *   **矩阵点亮标识**: 以半透明图标形式呈现微信、抖音、小红书、YouTube 四大平台。一旦影片发布登记，对应平台的高亮补丁就会被点亮。
*   **业务动作 (Action)**:
    *   `💡 下发生产(Job)`: 当发现有趣的事件，一键点击，将其正式推入工厂的中央调度池并生成独立 Job ID。
    *   `👁️ 跟踪节点`: 已下发的任务状态，点击直达“全链路流水线下钻系统”。

---

### 2.2 下钻节点层：工业级流水线播控台 (`/pipeline/<id>` 即 `pipeline.html`)

这是整个自动化流程最核心的**工程大脑**。每个视频任务在此被拆解为 5 大顺序执行节点。在此界面，你既可以一目了然看当前跑到哪了，也可以在异常或需要微调时进行【人工干预 (Human in the loop)】。

**【五大核心节点拆解】**

✅ **Node 1: 原始知识与深度挖掘 (Material & Enrichment)**
*   **当前展示**: 显示基础的历史短简片和关联事迹。
*   **核心操作 - 深度挖掘 (Enrichment)**: 若觉得原有系统素材过浅，或者你希望给视频增添某种视角（比如：“着重分析这场战役对 90 年代互联网泡沫的影响”），在文本框里输入定制 Prompt 并点击执行。大模型会二次读取原始文库重写深度背景（Rich Context），为下一个节点服务。

✅ **Node 2: 大语言模型剧本分镜 (LLM Script & Vision Blueprint)**
*   **当前展示**: 展现 AI 所吐出的**高精度短视频拆解 JSON**。这包含了旁白词 (Narration)、视频画面提示词 (Image Prompts)、物理转场 (Scene transitions)。
*   **核心操作 - 编剧干预**: 允许生成/重新生成。若 AI 的文案不满意，可以直接在可视化面板重新微调并保存，锁死该分镜骨架。

✅ **Node 3: 音画资产合成 (TTS & Flux Assets Synthesis)**
*   **当前展示**: 音频轨道路径与图片渲染（并行）完成状态。
*   **底层逻辑**: 它是无声分镜到可视化工业光轨的桥梁。系统会在后台并发请求专属模型（Edge-TTS / 豆包 等），生成主播真声配音，并基于 Node 2 的视觉提示词并行调用 Flux / Midjourney 等节点画分镜。

✅ **Node 4: Remotion 物理印制 (Rendering Cluster)**
*   **当前展示**: 压制出的 `.mp4` 最终成片绝对地址和下载高亮。
*   **底层逻辑**: 数据准备完毕后，打通到 Remotion 的 Node.js 集群（如 `npm run build`），将音频、图片、炫酷过场动画与特效强行混流渲染为 1080P/4K 原生级别输出视频，宣告制片阶段终结。

✅ **Node 5: 多平台分发与回收 (Publish & Analytics)**
*   **当前展示**: 下拉框填入已发布视频在该平台的具体 URL 并登记，形成发布足迹。
*   **核心操作 - 流量资产池**: 这为今后做业务增长构建了绝佳地基。后续可对接爬虫每日清洗更新 `publish_metrics` 表中的 Views（播放）、Likes（点赞）、Comments（评论），在界面矩阵对比各平台该视频的不同分发效果，进行归因分析。

---

## 3. 标准操作动线指北 (Operational Workflow)

作为一个典型的 IT 频道主理人，你每天的工作动线是这样的：

1. **每天早上打开手机 (192.168.0.31:8080)**：
   - 过滤 `月份` = 当前月。
   - 寻找 `爆款指数` >= 8，且图标状态为 `UNSTARTED` 的红星历史事件。
2. **决策立项**：
   - 选中主题，点击 `下发生产(Job)`。
3. **下钻调整 (进入 👁️ 跟踪节点)**：
   - 在 **Node 1**，输入你对这个事件独特的评论切入点，按 `挖掘` 丰富资料。
   - *(未来实现)*：后台自动接管 Node 2-> Node 3 -> Node 4，或者你手动按步触发去体验掌控感。
4. **视频分发与落盘**：
   - 到 **Node 4** 拿到成品 MP4 后，同步转发微/抖/红/Y。
   - 在 **Node 5** 录入并登记这些链接和平台。
5. **结束并喝咖啡**。此时退回首页 Dashboard，你的今日爆款任务整齐划一：胶囊为绿色的 `RENDER_COMPLETE`，右侧四个分发平台矩阵全部点亮。
